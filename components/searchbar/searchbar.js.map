{"version":3,"file":"components\\searchbar\\searchbar.js","sources":["webpack:///./src/components/searchbar/searchbar.ts?d8ce","webpack:///./src/components/searchbar/searchbar.ts"],"sourcesContent":["module.exports = require(\"!./searchbar.ts\")","Component({\r\n    options: {\r\n        addGlobalClass: true,\r\n        writeIdToDOM: true\r\n    } as any,\r\n    properties: {\r\n        extClass: {\r\n            type: String,\r\n            value: ''\r\n        },\r\n        focus: {\r\n            type: Boolean,\r\n            value: false\r\n        },\r\n        placeholder: {\r\n            type: String,\r\n            value: '搜索'\r\n        },\r\n        value: {\r\n            type: String,\r\n            value: ''\r\n        },\r\n        search: {\r\n            // 返回Promise的函数\r\n            type: null, // type: Function 等价 null\r\n            value: null\r\n        },\r\n        throttle: {\r\n            // 500ms内只会调用一次search函数\r\n            type: Number,\r\n            value: 500\r\n        },\r\n        cancelText: {\r\n            type: String,\r\n            value: '取消'\r\n        },\r\n        cancel: {\r\n            type: Boolean,\r\n            value: true\r\n        }\r\n    },\r\n    data: {\r\n        result: [] // 搜索结果\r\n    },\r\n    // @ts-ignore\r\n    lastSearch: Date.now(),\r\n    lifetimes: {\r\n        // @ts-ignore\r\n        attached() {\r\n            // @ts-ignore\r\n            if (this.data.focus) {\r\n                this.setData({\r\n                    searchState: true\r\n                })\r\n            }\r\n        }\r\n    },\r\n    methods: {\r\n        clearInput() {\r\n            // @ts-ignore\r\n            this.setData({\r\n                value: '',\r\n                focus: false,\r\n                result: []\r\n            })\r\n            // @ts-ignore\r\n            this.triggerEvent('clear')\r\n        },\r\n        // @ts-ignore\r\n        inputFocus(e) {\r\n            // this.setData({\r\n            //     searchState: true\r\n            // })\r\n            // @ts-ignore\r\n            this.triggerEvent('focus', e.detail)\r\n        },\r\n        // @ts-ignore\r\n        inputBlur(e) {\r\n            this.setData({\r\n                focus: false\r\n            })\r\n            this.triggerEvent('blur', e.detail)\r\n        },\r\n        showInput() {\r\n            this.setData({\r\n                focus: true,\r\n                searchState: true\r\n            })\r\n        },\r\n        hideInput() {\r\n            this.setData({\r\n                searchState: false\r\n            })\r\n            this.triggerEvent('cancel')\r\n        },\r\n        // @ts-ignore\r\n        inputChange(e) {\r\n            this.setData({\r\n                value: e.detail.value\r\n            })\r\n            this.triggerEvent('input', e.detail)\r\n            if (Date.now() - this.lastSearch < this.data.throttle) {\r\n                return\r\n            }\r\n            if (typeof this.data.search !== 'function') {\r\n                return\r\n            }\r\n            this.lastSearch = Date.now()\r\n            this.timerId = setTimeout(() => {\r\n                this.data\r\n                    .search(this.data.value)\r\n                    .then((json) => {\r\n                        this.setData({\r\n                            result: json\r\n                        })\r\n                    })\r\n                    .catch((err) => {\r\n                        console.error('search error', err)\r\n                    })\r\n            }, this.data.throttle)\r\n        },\r\n        // @ts-ignore\r\n        selectResult(e) {\r\n            const { index } = e.currentTarget.dataset\r\n            const item = this.data.result[index]\r\n            this.triggerEvent('selectresult', { index, item })\r\n        }\r\n    }\r\n})\r\n"],"mappings":";;;;;;;;;;;;;;AAAA;;;;;;;;;;;ACAA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AAFA;AAIA;AACA;AACA;AAFA;AAIA;AACA;AACA;AAFA;AAIA;AACA;AACA;AAAA;AACA;AAHA;AAKA;AACA;AACA;AACA;AAHA;AAKA;AACA;AACA;AAFA;AAIA;AACA;AACA;AAFA;AA/BA;AAoCA;AACA;AACA;AAFA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AAGA;AACA;AATA;AAWA;AACA;AACA;AACA;AACA;AACA;AACA;AAHA;AACA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AAGA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;AADA;AAGA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AADA;AAGA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AAGA;AACA;AADA;AAGA;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AAEA;AACA;AAAA;AAAA;AAAA;AACA;AArEA;AAzDA;;;;;;;;","sourceRoot":""}